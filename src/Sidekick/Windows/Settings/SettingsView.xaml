<Window x:Class="Sidekick.Windows.Settings.SettingsView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
        xmlns:local="clr-namespace:Sidekick.Windows.Settings"
        xmlns:UC="clr-namespace:Sidekick.Windows.Settings.UserControls"
        xmlns:enums="clr-namespace:Sidekick.Core.Settings;assembly=Sidekick.Core"
        mc:Ignorable="d"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResizeWithGrip"
        AllowsTransparency="True"
        Height="400" 
        MinHeight="400"
        Width="500"
        MinWidth="500"
        Topmost="True"
        ShowInTaskbar="False"
        WindowStyle="None"
        BorderThickness="1 3 1 1"
        BorderBrush="{DynamicResource PrimaryColor}"
        Background="{DynamicResource BackgroundColor}"
        d:DesignHeight="450" d:DesignWidth="800"
        MouseLeftButtonDown="Window_MouseLeftButtonDown">
    <Window.Resources>
        <Style TargetType="{x:Type TextBox}">
            <Setter Property="BorderBrush" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="Foreground" Value="{DynamicResource LightColor}" />
            <Setter Property="TextWrapping" Value="NoWrap" />
        </Style>

        <Style x:Key="ScrollThumbs" TargetType="{x:Type Thumb}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Thumb}">
                        <Grid x:Name="Grid">
                            <Rectangle HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="Auto" Height="Auto" Fill="Transparent" />
                            <Border x:Name="Rectangle1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="Auto" Height="Auto"  Background="{TemplateBinding Background}" />
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="Tag" Value="Horizontal">
                                <Setter TargetName="Rectangle1" Property="Width" Value="Auto" />
                                <Setter TargetName="Rectangle1" Property="Height" Value="7" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="{x:Type ScrollBar}" TargetType="{x:Type ScrollBar}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ScrollBar}">
                        <Grid x:Name="GridRoot" Width="5" Background="{DynamicResource BackgroundColorLight}">
                            <Track x:Name="PART_Track" Grid.Row="0" IsDirectionReversed="true" Focusable="False">
                                <Track.Thumb>
                                    <Thumb x:Name="Thumb" Background="{DynamicResource AccentColor}" Style="{DynamicResource ScrollThumbs}" />
                                </Track.Thumb>
                                <Track.IncreaseRepeatButton>
                                    <RepeatButton x:Name="PageUp" Command="ScrollBar.PageDownCommand" Opacity="0" Focusable="False" />
                                </Track.IncreaseRepeatButton>
                                <Track.DecreaseRepeatButton>
                                    <RepeatButton x:Name="PageDown" Command="ScrollBar.PageUpCommand" Opacity="0" Focusable="False" />
                                </Track.DecreaseRepeatButton>
                            </Track>
                        </Grid>

                        <ControlTemplate.Triggers>
                            <Trigger Property="IsEnabled" Value="false">
                                <Setter TargetName="Thumb" Property="Visibility" Value="Collapsed" />
                            </Trigger>
                            <Trigger SourceName="Thumb" Property="IsMouseOver" Value="True" >
                                <Setter TargetName="Thumb" Property="Background" Value="{DynamicResource LightColor}" />
                            </Trigger>
                            <Trigger Property="Orientation" Value="Horizontal">
                                <Setter TargetName="GridRoot" Property="LayoutTransform">
                                    <Setter.Value>
                                        <RotateTransform Angle="-90" />
                                    </Setter.Value>
                                </Setter>
                                <Setter TargetName="PART_Track" Property="LayoutTransform">
                                    <Setter.Value>
                                        <RotateTransform Angle="-90" />
                                    </Setter.Value>
                                </Setter>
                                <Setter Property="Width" Value="Auto" />
                                <Setter Property="Height" Value="12" />
                                <Setter TargetName="Thumb" Property="Tag" Value="Horizontal" />
                                <Setter TargetName="PageDown" Property="Command" Value="ScrollBar.PageLeftCommand" />
                                <Setter TargetName="PageUp" Property="Command" Value="ScrollBar.PageRightCommand" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <BorderGapMaskConverter x:Key="BorderGapMaskConverter"/>
        <Style TargetType="{x:Type GroupBox}">
            <Setter Property="BorderBrush" Value="{DynamicResource PrimaryColor}"/>
            <Setter Property="Margin" Value="1"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type GroupBox}">
                        <Grid SnapsToDevicePixels="true">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="6" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="6" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                                <RowDefinition Height="6" />
                            </Grid.RowDefinitions>
                            <Border CornerRadius="4" Grid.Row="1" Grid.RowSpan="3" Grid.Column="0" Grid.ColumnSpan="4" BorderThickness="{TemplateBinding BorderThickness}" BorderBrush="Transparent" Background="{TemplateBinding Background}" />
                            <Border Name="Header" Padding="3,1,3,0" Grid.Row="0" Grid.RowSpan="2" Grid.Column="1">
                                <ContentPresenter ContentSource="Header" RecognizesAccessKey="true" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                            </Border>
                            <ContentPresenter Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="2" Margin="{TemplateBinding Padding}" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                            <Border Grid.Row="1" Grid.RowSpan="3" Grid.ColumnSpan="4"  BorderThickness="{TemplateBinding BorderThickness}" BorderBrush="{TemplateBinding BorderBrush}" CornerRadius="3">
                                <Border.OpacityMask>
                                    <MultiBinding Converter="{StaticResource BorderGapMaskConverter}" ConverterParameter="7">
                                        <Binding ElementName="Header" Path="ActualWidth" />
                                        <Binding Path="ActualWidth" RelativeSource="{RelativeSource Self}" />
                                        <Binding Path="ActualHeight" RelativeSource="{RelativeSource Self}" />
                                    </MultiBinding>
                                </Border.OpacityMask>
                            </Border>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <SolidColorBrush x:Key="TextColor" Color="#FFE6E6E6" />
        <SolidColorBrush x:Key="BackgroundColor" Color="#FF1E1E1E" />
        <SolidColorBrush x:Key="BackgroundColorLight" Color="#FF252525" />

        <SolidColorBrush x:Key="PrimaryColor" Color="#FF5C58B6" />
        <SolidColorBrush x:Key="SecondaryColor" Color="#FFB957CE" />
        <SolidColorBrush x:Key="LightColor" Color="#FF5994CE" />
        <SolidColorBrush x:Key="AccentColor" Color="#FF3A4E93" />

        <Style TargetType="{x:Type Button}">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="{DynamicResource PrimaryColor}"/>
            <Setter Property="Foreground" Value="{DynamicResource LightColor}"/>
            <Setter Property="Margin" Value="1"/>
            <Setter Property="Padding" Value="0 -2 0 0"/>
        </Style>

        <Style TargetType="TabItem" BasedOn="{StaticResource {x:Type TabItem}}">
            <Setter Property="Foreground" Value="{DynamicResource LightColor}"/>
            <Setter Property="Background" Value="{DynamicResource BackgroundColor}"/>
            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
            <Setter Property="VerticalContentAlignment" Value="Stretch"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TabItem}">
                        <Grid SnapsToDevicePixels="true">
                            <Border x:Name="HeaderBorder" Padding="2 0 2 1" BorderThickness="1 1 1 0" Margin="-2 -2 1 0"
                            Background="{DynamicResource BackgroundColor}" 
                            BorderBrush="{DynamicResource PrimaryColor}">
                                <ContentPresenter x:Name="Content" ContentSource="Header"
                                          HorizontalAlignment="{Binding Path=HorizontalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"
                                          VerticalAlignment="{Binding Path=VerticalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"
                                          />
                            </Border>
                            <Border x:Name="TopLineCover" BorderThickness="1 1 1 0" Margin="-2 -2 1 0" Height="1" Panel.ZIndex="100"
                            Background="{DynamicResource BackgroundColor}" BorderBrush="{DynamicResource PrimaryColor}"
                            VerticalAlignment="Top" HorizontalAlignment="Stretch" Visibility="Collapsed"/>
                            <Border x:Name="BottomLineCover" BorderThickness="0 0 0 3" Margin="-1 0 2 -2" Panel.ZIndex="100" BorderBrush="{DynamicResource BackgroundColor}"
                            VerticalAlignment="Bottom" HorizontalAlignment="Stretch" Visibility="Collapsed"/>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsMouseOver" Value="True"/>
                                    <Condition Property="IsSelected" Value="False"/>
                                </MultiTrigger.Conditions>
                                <Setter Property="Background" TargetName="HeaderBorder" Value="{DynamicResource BackgroundColorLight}"/>
                            </MultiTrigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" TargetName="HeaderBorder" Value="{DynamicResource BackgroundColor}"/>
                                <Setter Property="Visibility" TargetName="TopLineCover" Value="Visible"/>
                                <Setter Property="Visibility" TargetName="BottomLineCover" Value="Visible"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid VerticalAlignment="Stretch" HorizontalAlignment="Stretch">
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="30"/>
        </Grid.RowDefinitions>
        <TabControl Grid.Row="0" Background="Transparent" BorderBrush="{DynamicResource PrimaryColor}">
            <TabItem x:Name="tabItemGeneral" Header="General">
                <Grid Margin="0 1 0 0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition/>
                        <RowDefinition/>
                    </Grid.RowDefinitions>
                    <GroupBox x:Name="groupBoxWikiSettings" Header="Wiki Settings" Grid.Row="0" Grid.Column="0" Margin="-2,-2,4,4"></GroupBox>
                    <GroupBox x:Name="groupBoxLanguageSettings" Header="LanguageSettings" Grid.Row="0" Grid.Column="1">
                        <Label x:Name="labelLanguageDescription" Content="Choose Sidekick's UI Language" HorizontalAlignment="Left" Margin="20,13,0,0" VerticalAlignment="Top" Width="187" Foreground="{DynamicResource LightColor}" FontSize="11"/>
                    </GroupBox>
                    <GroupBox Header="Settings Group 3" Grid.Row="1" Grid.Column="0">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition/>
                                <ColumnDefinition/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition></RowDefinition>
                                <RowDefinition></RowDefinition>
                                <RowDefinition></RowDefinition>
                                <RowDefinition></RowDefinition>
                            </Grid.RowDefinitions>

                            <Label Grid.Row="0" Grid.Column="0" Content="Character Name" Foreground="{DynamicResource LightColor}" VerticalContentAlignment="Center"/>
                            <TextBox Grid.Row="0" Text="{Binding Path=Settings.GeneralSettings[(enums:GeneralSetting)CharacterName]}" Grid.Column="1" BorderThickness="1" BorderBrush="{DynamicResource PrimaryColor}" Margin="1" Foreground="{DynamicResource LightColor}" VerticalContentAlignment="Center">
                                <TextBox.ContextMenu>
                                    <ContextMenu Visibility="Collapsed"/>
                                </TextBox.ContextMenu>
                            </TextBox>
                        </Grid>
                    </GroupBox>
                    <GroupBox Header="Settings Group 4" Grid.Row="1" Grid.Column="1"></GroupBox>
                    <Grid HorizontalAlignment="Left" Height="151" Margin="1,19,0,0" VerticalAlignment="Top" Width="241" RenderTransformOrigin="0.48,0.51">
                        <RadioButton x:Name="radioButtonPOEWiki" Content="POE Wiki" HorizontalAlignment="Left" Margin="19,55,0,0" VerticalAlignment="Top" Background="White" Foreground="{DynamicResource LightColor}"/>
                        <RadioButton x:Name="radioButtonPOEDb" Content="POE Db" HorizontalAlignment="Left" Margin="19,87,0,0" VerticalAlignment="Top" Foreground="{DynamicResource LightColor}"/>
                        <Label x:Name="labelWikiDescription" Content="Choose which Wiki Page should be displayed" HorizontalAlignment="Left" Margin="0,10,0,0" VerticalAlignment="Top" Width="231" Foreground="{DynamicResource LightColor}" FontSize="11"/>
                    </Grid>
                    <ComboBox x:Name="comboBoxUILanguages" Grid.Column="1" HorizontalAlignment="Left" Margin="26,77,0,0" VerticalAlignment="Top" Width="190" BorderBrush="White" Foreground="Black">
                        <ComboBox.Background>
                            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                <GradientStop Color="#FFF0F0F0" Offset="0"/>
                                <GradientStop Color="White" Offset="1"/>
                            </LinearGradientBrush>
                        </ComboBox.Background>
                    </ComboBox>
                </Grid>
            </TabItem>
            <TabItem x:Name="tabItemKeybindings" Header="Keybindings">
                <ScrollViewer Name="_keybindingsViewer" VerticalScrollBarVisibility="Auto">
                    <ItemsControl ItemsSource="{Binding Path=Settings.KeybindSettings}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="200"/>
                                    </Grid.ColumnDefinitions>
                                    <Label Grid.Column="0" Content="{Binding Path=Key}" Foreground="{DynamicResource LightColor}" VerticalContentAlignment="Center"/>
                                    <UC:KeybindEditor Grid.Column="1" Hotkey="{Binding Path=Value}" HotkeyChanged="KeybindEditor_HotkeyChanged" HotkeyChanging="KeybindEditor_HotkeyChanging"/>
                                </Grid>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>
            </TabItem>
        </TabControl>

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="100"/>
                <ColumnDefinition Width="100"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Button Grid.Column="0" Content="Save Changes" Click="SaveChanges_Click"></Button>
            <Button Grid.Column="1" Content="Discard Changes" Click="DiscardChanges_Click"></Button>
        </Grid>
    </Grid>
</Window>
